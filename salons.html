<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Salons in City</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet" />
<style>
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    transition: all 0.3s ease;
  }

  body {
    font-family: 'Inter', sans-serif;
    background: linear-gradient(to right, #f0f4ff, #e8f0fe);
    color: #1a237e;
    padding: 40px 20px;
    min-height: 100vh;
  }

  .top-logo {
    position: fixed;
    top: 20px;
    left: 20px;
    font-size: 22px;
    font-weight: 600;
    color: rgb(39, 131, 201);
    display: flex;
    align-items: center;
    z-index: 10;
    text-decoration: none;
  
  }

  .top-logo i {
    margin-right: 10px;
    font-size: 28px;
    animation: pulse 2s infinite;
  }

  .container {
    display: flex;
    max-width: 1400px;
    margin: auto;
    gap: 2rem;
    animation: fadeIn 0.6s ease-in-out;
    align-items: flex-start;
  }

  #filters {
    width: 280px;
    background: rgba(255, 255, 255, 0.85);
    padding: 2rem;
    border-radius: 16px;
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
    height: fit-content;
    backdrop-filter: blur(6px);
    position: sticky;
    top: 40px;
  }

  #filters h2 {
    font-size: 1.7rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    color: #0d47a1;
    border-bottom: 2px solid #1e88e5;
    padding-bottom: 5px;
  }

  #filters strong {
    font-size: 1.1rem;
    margin-top: 1.5rem;
    display: block;
    color: #0d47a1;
  }

  #filters label {
    display: flex;
    align-items: center;
    margin: 6px 0;
    font-size: 0.95rem;
    gap: 6px;
    cursor: pointer;
  }

  #filters input[type="checkbox"] {
    transform: scale(1.2);
    accent-color: #1e88e5;
    cursor: pointer;
  }

  main {
    background: #ffffff;
    padding: 2rem;
    border-radius: 16px;
    box-shadow: 0 12px 28px rgba(0, 0, 0, 0.08);
    flex-grow: 1;
    width: 100%;
  }

  h1 {
    font-size: 2rem;
    color: #0d47a1;
    margin-bottom: 1.5rem;
    border-bottom: 2px solid #1e88e5;
    padding-bottom: 0.4rem;
  }

  #search-bar {
    width: 100%;
    max-width: 500px;
    padding: 12px 18px;
    font-size: 1rem;
    border: 2px solid #b3cde0;
    border-radius: 10px;
    margin-bottom: 1.5rem;
    background: #f9fbff;
    box-shadow: 0 2px 6px rgba(0,0,0,0.04);
  }

  #search-bar:focus {
    outline: none;
    border-color: #1e88e5;
    background: #e3f2fd;
  }

  ul.salon-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
    gap: 1.5rem;
    padding: 0;
    list-style: none;
  }

  ul.salon-list li {
    background: #ffffff;
    padding: 1.25rem;
    border: 1px solid #e0e0e0;
    border-left: 6px solid #1e88e5;
    border-radius: 16px;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  ul.salon-list li:hover {
    transform: scale(1.02);
    box-shadow: 0 14px 30px rgba(0, 0, 0, 0.1);
  }

  ul.salon-list li img {
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-radius: 12px;
    border: 1px solid #ccc;
  }

  ul.salon-list li .details {
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
  }

  ul.salon-list li .details strong {
    font-size: 1.4rem;
    font-weight: 600;
    color: #0d47a1;
  }

  ul.salon-list li .details p {
    font-size: 0.95rem;
    color: #555;
    margin: 0;
  }

  ul.salon-list li .btn {
    display: inline-block;
    padding: 10px 16px;
    margin-top: 10px;
    background: linear-gradient(to right, #42a5f5, #1e88e5);
    color: white;
    text-decoration: none;
    font-weight: 600;
    border-radius: 8px;
    text-align: center;
    letter-spacing: 0.5px;
    box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
    transition: all 0.25s ease;
  }

  ul.salon-list li .btn:hover {
    background: linear-gradient(to right, #1e88e5, #1565c0);
    transform: translateY(-2px);
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @media (max-width: 1024px) {
    .container {
      flex-direction: column;
    }

    #filters {
      width: 100%;
      position: relative;
      top: unset;
    }
  }

  @media (max-width: 500px) {
    #search-bar {
      width: 100%;
      font-size: 0.95rem;
    }

    .top-logo {
      font-size: 18px;
    }

    .top-logo i {
      font-size: 22px;
    }
  }
.details p {
  font-size: 1.3rem;
  color: #fbc02d; /* gold color */
  letter-spacing: 2px;
}

</style>

</head>

<body>
<a class="top-logo" href="#">
  <i class="fas fa-cut"></i>
  <span>EasySalonBooking</span>
</a>

  <div class="container">
    <section id="filters">
      <h2>Filters</h2>
      <div>
        <strong>Price Range (â‚¹)</strong>
        <label><input type="checkbox" name="price" value="100" /> Up to 100</label>
        <label><input type="checkbox" name="price" value="300" /> Up to 300</label>
        <label><input type="checkbox" name="price" value="500" /> Up to 500</label>
      </div>
      <div style="margin-top: 1rem;">
        <strong>Welcome Drink</strong>
        <label><input type="checkbox" name="welcomeDrink" value="yes" /> Available</label>
        <label><input type="checkbox" name="welcomeDrink" value="no" /> Not Available</label>
      </div>
      <div style="margin-top: 1rem;">
        <strong>Extra Services</strong>
        <label><input type="checkbox" name="extra" value="spa" /> Spa</label>
        <label><input type="checkbox" name="extra" value="massage" /> Massage</label>
        <label><input type="checkbox" name="extra" value="facial" /> Facial</label>
      </div>
<strong>Rating</strong>
<label><input type="checkbox" name="rating" value="4"> 4â˜… & above</label>
<label><input type="checkbox" name="rating" value="3"> 3â˜… & above</label>

<strong>Open Now</strong>
<label><input type="checkbox" name="openNow" value="true"> Only show salons that are open now</label>

<strong>Facilities</strong>
<label><input type="checkbox" name="facility" value="AC"> AC</label>
<label><input type="checkbox" name="facility" value="WiFi"> Wi-Fi</label>
<label><input type="checkbox" name="facility" value="Parking"> Parking</label>

<strong>Staff Preference</strong>
<label><input type="checkbox" name="staff" value="Male"> Male Staff</label>
<label><input type="checkbox" name="staff" value="Female"> Female Staff</label>
    </section>

    <main>
      <h1>Salons in <span id="city-name"></span></h1>
      <input type="text" id="search-bar" placeholder="Search salons by name..." />
      <ul class="salon-list" id="salon-list">
        <li id="loading">Loading salons...</li>
      </ul>
      <div id="salon-details" style="display:none;"></div>
    </main>
  </div>

  <script>
    const city = new URLSearchParams(window.location.search).get('city');
    document.getElementById('city-name').textContent = city || 'Unknown';

    const salonListEl = document.getElementById('salon-list');
    const searchBar = document.getElementById('search-bar');
    const filters = document.getElementById('filters');
function getStars(rating) {
  const maxStars = 5;
  let stars = '';
  for (let i = 1; i <= maxStars; i++) {
    stars += i <= rating 
      ? 'â­'  // filled star
      : 'â˜†'; // empty star (optional, or skip to show only filled stars)
  }
  return stars;
}


    let salons = [];

    function renderSalons(filteredSalons) {
      document.getElementById('loading')?.remove();

      if (filteredSalons.length === 0) {
        salonListEl.innerHTML = '<li>No salons found.</li>';
        return;
      }

      salonListEl.innerHTML = '';
      let i = 0;

      function renderNext() {
        if (i >= filteredSalons.length) return;

        const salon = filteredSalons[i];
        const li = document.createElement('li');
        li.innerHTML = `
          <img src="/uploads/${salon.photo}" alt="${salon.salonName}" loading="lazy" />
          <div class="details">
            <strong>${salon.salonName}</strong>
            <p>Location: ${salon.location}</p>
            <p>Price Range: â‚¹${salon.priceRange}</p>
           <p>${getStars(salon.rating)}</p>

            <p>${salon.description}</p>
          </div>
          <a href="salon-details.html?id=${salon.id}" class="btn">View Details</a>
        `;
        salonListEl.appendChild(li);
        i++;
        requestAnimationFrame(renderNext);
      }

      renderNext();
    }

    function applyFilters() {
      let filtered = salons;

      const query = searchBar.value.toLowerCase();
      if (query) {
        filtered = filtered.filter(salon =>
          salon.salonName.toLowerCase().includes(query)
        );
      }

      const checkedPrices = [...filters.querySelectorAll('input[name="price"]:checked')]
        .map(input => Number(input.value));
      if (checkedPrices.length > 0) {
        filtered = filtered.filter(salon =>
          checkedPrices.some(priceLimit => salon.priceRange <= priceLimit)
        );
      }
// â­ Rating Filter
const checkedRatings = [...filters.querySelectorAll('input[name="rating"]:checked')]
  .map(input => Number(input.value));
if (checkedRatings.length > 0) {
  filtered = filtered.filter(salon =>
    checkedRatings.some(ratingMin => salon.rating >= ratingMin)
  );
}

// ðŸ•’ Open Now Filter (dummy logic â€” you can enhance using actual hours)
const isOpenNowChecked = filters.querySelector('input[name="openNow"]:checked');
if (isOpenNowChecked) {
  const currentHour = new Date().getHours();
  filtered = filtered.filter(salon => {
    const open = Number(salon.openHour || 9);
    const close = Number(salon.closeHour || 20);
    return currentHour >= open && currentHour <= close;
  });
}

// ðŸ§´ Facility Filter
const checkedFacilities = [...filters.querySelectorAll('input[name="facility"]:checked')]
  .map(input => input.value);
if (checkedFacilities.length > 0) {
  filtered = filtered.filter(salon =>
    salon.facilities &&
    checkedFacilities.every(fac => salon.facilities.toLowerCase().includes(fac.toLowerCase()))
  );
}

// ðŸ‘¨â€ðŸ’¼ Staff Preference Filter
const checkedStaff = [...filters.querySelectorAll('input[name="staff"]:checked')]
  .map(input => input.value.toLowerCase());
if (checkedStaff.length > 0) {
  filtered = filtered.filter(salon =>
    salon.staff &&
    checkedStaff.some(pref => salon.staff.toLowerCase().includes(pref))
  );
}

      const checkedWelcome = [...filters.querySelectorAll('input[name="welcomeDrink"]:checked')]
        .map(input => input.value.toLowerCase());
      if (checkedWelcome.length > 0) {
        filtered = filtered.filter(salon =>
          salon.welcomeDrink && checkedWelcome.includes(salon.welcomeDrink.toLowerCase())
        );
      }

      const checkedExtras = [...filters.querySelectorAll('input[name="extra"]:checked')]
        .map(input => input.value);
      if (checkedExtras.length > 0) {
        filtered = filtered.filter(salon =>
          salon.extras && checkedExtras.every(extra => salon.extras.split(',').includes(extra))
        );
      }

      renderSalons(filtered);
    }

    function fetchSalons() {
      if (!city) {
        salonListEl.innerHTML = '<li>Please select a city.</li>';
        return;
      }

      fetch(`https://salon-booking-backend-vsaz.onrender.com/salons/city/${encodeURIComponent(city)}`)
        .then(res => {
          if (!res.ok) throw new Error('Failed to fetch salons');
          return res.json();
        })
        .then(data => {
          salons = data;
          applyFilters();
        })
        .catch(() => {
          salonListEl.innerHTML = '<li>Error loading salons. Please try again.</li>';
        });
    }

    // Event Listeners
    searchBar.addEventListener('input', applyFilters);
    filters.querySelectorAll('input').forEach(input => {
      input.addEventListener('change', applyFilters);
    });

    fetchSalons();
  </script>
</body>
</html>

